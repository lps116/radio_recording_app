{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}


{% block content %}
<!-- https://www.bootdey.com/snippets/view/bs4-social-about -->
{% include 'components/profile_navigation.html' with user=user active="profile"%}

<!-- https://www.bootdey.com/snippets/view/support-tickets#html -->
<div class="container">
  <section class="content">
    <div class="row">
      <div class="col-md-3">
        <div class="card support">
          <div class="card-header">
            <h5 class="card-title mb-0">Overview</h5>
          </div>

          <div class="card-body">
            {% if inprogress_recordings.all %}
            <p><strong>In Progress</strong></p>
            <ul class="support-label">
              {% for recording in inprogress_recordings %}
              {% if recording.radio_station.name|length > 20 %}
              <li>{{recording.radio_station.name|slice:":20"}}...<span class="pull-right"><div class="spinner-grow text-success spinner-grow-sm" role="status"><span class="sr-only">Loading...</span></div></span></li>
              {% else %}
              <li>{{recording.radio_station.name}}<span class="pull-right"><div class="spinner-grow text-success spinner-grow-sm" role="status"><span class="sr-only">Loading...</span></div></span></li>
              {% endif %}
              {% endfor %}
            </ul>
            <hr>
            {% endif %}
            <p><strong>Pending</strong></p>
            <ul>
              {% if scheduled_recordings %}
              {% for recording in scheduled_recordings %}

              {% if recording.radio_station.name|length > 20 %}
              <li>{{recording.radio_station.name|slice:":20"}}...<span class="pull-right"><img src="{% static 'images/calendar.svg'%}" style="height: 20px; width: 20px;"alt=""></span></li>
              {% else %}
              <li>{{recording.radio_station.name}}<span class="pull-right"><img src="{% static 'images/calendar.svg'%}" style="height: 20px; width: 20px;"alt=""></span></li>
              {% endif %}

              {% endfor%}
              {% else %}
              <li>No upcoming recordings...<span class="pull-right"></span></li>
              {% endif %}
            </ul>
            <hr>

            {% if request.user == user %}
            <p class="mt-2"><strong>Schedule a Recording</strong></p>
            <form action="." method="POST">
              {% csrf_token %}
              {{form|crispy}}
              <p>Timezone set to British Summer Time. Current time in BST: {% now "H:i" %}</p>
              <input type="Submit" class="btn btn-primary" value="Schedule">
            </form>
            {% endif %}
          </div>
        </div>
      </div>


      <div class="col-md-9">
        <div class="card support-content">
          <div class="card-header">
            {% if request.user == user %}
            <h5 class="card-title mb-0">My Completed Recordings</h5>
            {% else %}
            <h5 class="card-title mb-0">{{user.username}}'s Recordings</h5>
            {% endif %}
          </div>
          <div class="row">
            <div class="col-md-12">
                <ul class="list-group fa-padding">
                  {% for recording in completed_recordings %}
                  {% include 'components/recording_card.html' with recording=recording user=user page="Profile" %}
                  {% endfor %}
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>
  {% endblock %}
